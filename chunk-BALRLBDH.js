import{a as Z}from"./chunk-SGQILQIW.js";import{a as y}from"./chunk-DRNA2Y2Q.js";import{a as j,e as $}from"./chunk-S73WMLDN.js";import{a as O}from"./chunk-ITUVS2WK.js";import"./chunk-23P6OKCW.js";import{a as M}from"./chunk-7Y7O4CRB.js";import{a as V}from"./chunk-LJQV5NXZ.js";import"./chunk-7G2AXBS3.js";import{g as T,s as x}from"./chunk-Y4NPCKFB.js";import{g as h}from"./chunk-OOKJWEDJ.js";import{jb as N,kb as Y,ta as G,wa as C,ya as I}from"./chunk-4MVBMYBR.js";import{$a as n,Ab as u,Ba as a,Ca as q,Dc as F,Hc as _,Ic as X,Kc as k,Mc as L,Nc as E,Ra as r,T as B,Yc as P,_ as d,ab as s,bb as p,ca as m,d as w,ib as l,lb as J,mb as K,sa as f,sb as g,tb as z,tc as Q,wc as S,z as W}from"./chunk-NE7DBUAQ.js";var R=(()=>{class o{constructor(){this.save=new f,this.elIds=I,this.passwordVisible=!1,this.visibilityIcon=y.getVisibilityIcon(()=>this.togglePasswordVisibility()),this.togglePasswordVisibility=()=>{this.passwordVisible=!this.passwordVisible,this.visibilityIcon.color=this.passwordVisible?"primary":"accent"}}onSubmit(){N.onSubmit(this.form,this.save)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=m({type:o,selectors:[["app-login-form"]],inputs:{form:"form"},outputs:{save:"save"},standalone:!0,features:[u],decls:7,vars:6,consts:[["app-form-layout","",1,"side-form-layout",3,"ngSubmit","id","formGroup"],[1,"form-grid"],["fcName","userNameOrEmail","labelText","User name or Email","placeholder","Enter your user name or email"],["fcName","password","labelText","Password","placeholder","Enter your password",3,"type","labelIcon"],[1,"form-buttons"],["model","raised","type","submit",3,"elId","disabled"]],template:function(t,e){t&1&&(n(0,"form",0),l("ngSubmit",function(){return e.onSubmit()}),n(1,"div",1),p(2,"app-input",2)(3,"app-input",3),n(4,"div",4)(5,"app-button",5),g(6,"Login"),s()()()()),t&2&&(r("id",e.elIds.LoginForm)("formGroup",e.form),a(3),r("type",e.passwordVisible?"text":"password")("labelIcon",e.visibilityIcon),a(2),r("elId",e.elIds.LoginSubmit)("disabled",e.form.invalid))},dependencies:[P,L,_,E,M,O,h]})}}return o})();var H=(()=>{class o{constructor(){this.save=new f,this.cancel=new f,this.remove=new f,this.elIds=I,this.passwordVisible=!1,this.visibilityIcon=y.getVisibilityIcon(()=>this.togglePasswordVisibility()),this.passwordHelpers=y.getPasswordHelpers(),this.togglePasswordVisibility=()=>{this.passwordVisible=!this.passwordVisible,this.visibilityIcon.color=this.passwordVisible?"primary":"accent"}}onSubmit(){N.onSubmit(this.form,this.save)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=m({type:o,selectors:[["app-signup-form"]],inputs:{form:"form"},outputs:{save:"save",cancel:"cancel",remove:"remove"},standalone:!0,features:[u],decls:10,vars:9,consts:[["app-form-layout","",1,"side-form-layout",3,"ngSubmit","id","formGroup"],[1,"form-grid"],["fcName","userName","labelText","User name","placeholder","Enter your user name"],["fcName","name","labelText","Name","placeholder","Enter your name"],["fcName","email","labelText","Email","placeholder","Enter your email"],["fcName","password","labelText","Password","placeholder","Enter your password",3,"type","labelIcon","helpers"],["fcName","confirmPassword","labelText","Confirm Password","placeholder","Confirm password",3,"type","labelIcon"],[1,"form-buttons"],["model","raised","type","submit",3,"elId","disabled"]],template:function(t,e){t&1&&(n(0,"form",0),l("ngSubmit",function(){return e.onSubmit()}),n(1,"div",1),p(2,"app-input",2)(3,"app-input",3)(4,"app-input",4)(5,"app-input",5)(6,"app-input",6),n(7,"div",7)(8,"app-button",8),g(9,"Sign Up"),s()()()()),t&2&&(r("id",e.elIds.SignupForm)("formGroup",e.form),a(5),r("type",e.passwordVisible?"text":"password")("labelIcon",e.visibilityIcon)("helpers",e.passwordHelpers),a(),r("type",e.passwordVisible?"text":"password")("labelIcon",e.visibilityIcon),a(2),r("elId",e.elIds.SignupSubmit)("disabled",e.form.invalid))},dependencies:[P,L,_,E,M,O,h]})}}return o})();var ne=["*"],U=(()=>{class o{get isLoginPage(){return this.router.url===C.login}constructor(i){this.router=i,this.switchPageLabel="Already have an account? Login",this.authImage={src:"assets/img/auth-bg.png",alt:"auth",priority:!0,width:500,height:429}}ngOnInit(){this.setSwitchPageLabel(),this.router.events.pipe(W(i=>i instanceof Q),B(()=>this.setSwitchPageLabel())).subscribe()}switchPage(){this.router.navigate([this.isLoginPage?C.signup:C.login])}setSwitchPageLabel(){this.switchPageLabel=this.isLoginPage?"Don't have an account? Sign up":"Already have an account? Login"}static{this.\u0275fac=function(t){return new(t||o)(q(S))}}static{this.\u0275cmp=m({type:o,selectors:[["app-auth-page-layout"]],standalone:!0,features:[u],ngContentSelectors:ne,decls:8,vars:2,consts:[[1,"auth-container"],[1,"side-image"],[3,"image"],[1,"page-content"],[1,"form-buttons"],["model","raised","elId","cAuthenticationSwitchPage",3,"clicked"]],template:function(t,e){t&1&&(J(),n(0,"div",0)(1,"div",1),p(2,"app-image",2),s(),n(3,"section",3),K(4,0,["#pageContent",""]),n(5,"div",4)(6,"app-button",5),l("clicked",function(){return e.switchPage()}),g(7),s()()()()),t&2&&(a(2),r("image",e.authImage),a(5),z(e.switchPageLabel))},dependencies:[Z,h],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;height:100vh}.side-image[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1}.side-image[_ngcontent-%COMP%]   app-image[_ngcontent-%COMP%]{width:638px}.page-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:344px;background:var(--secondary-dark);color:#fff;padding:1rem 1.5rem;box-shadow:0 0 10px #000;overflow-y:auto}@media screen and (max-width: 982px){.page-content[_ngcontent-%COMP%]{flex:1}.side-image[_ngcontent-%COMP%]{display:none}}"]})}}return o})();var ee=(()=>{class o{constructor(){this.service=d(x),this.toaster=d(T)}ngOnInit(){this.initForm()}initForm(){this.form=j.from($())}signup(i){return w(this,null,function*(){let t=j.toJson(i);try{yield this.service.signup(t),this.toaster.success("Registro exitoso!")}catch(e){this.toaster.error(e?.error?.message||"No se pudo registrar el usuario")}})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=m({type:o,selectors:[["app-signup"]],standalone:!0,features:[u],decls:3,vars:1,consts:[["titleText","Signup"],[3,"save","form"]],template:function(t,e){t&1&&(n(0,"app-auth-page-layout"),p(1,"app-title",0),n(2,"app-signup-form",1),l("save",function(A){return e.signup(A)}),s()()),t&2&&(a(2),r("form",e.form))},dependencies:[U,V,H],encapsulation:2})}}return o})();var v=class o extends X{static from(c){return new o(c)}static getFormKeys(){return["userNameOrEmail","password"]}static toEntityWithUserName(c){return{password:c.password.value,userName:c.userNameOrEmail.value}}static toEntityWithEmail(c){return{password:c.password.value,email:c.userNameOrEmail.value}}},te=()=>({userNameOrEmail:new k("",{nonNullable:!0,validators:[F.required,F.maxLength(100)]}),password:new k("",{nonNullable:!0,validators:[F.required]})});var oe=(()=>{class o{constructor(){this.service=d(x),this.toaster=d(T),this.router=d(S)}ngOnInit(){this.initForm()}initForm(){this.form=v.from(te())}login(i){return w(this,null,function*(){let t=Y.isEmail(i.controls.userNameOrEmail.value)?v.toEntityWithEmail(i.controls):v.toEntityWithUserName(i.controls);try{let e=yield this.service.login(t);e?.token?(localStorage.setItem("token",e.token),this.toaster.success("Login successful!"),yield this.router.navigate(["/home"])):this.toaster.error("Login failed: Token not received")}catch{this.toaster.error("Invalid username or password")}})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=m({type:o,selectors:[["app-login"]],standalone:!0,features:[u],decls:3,vars:1,consts:[["titleText","Login"],[3,"save","form"]],template:function(t,e){t&1&&(n(0,"app-auth-page-layout"),p(1,"app-title",0),n(2,"app-login-form",1),l("save",function(A){return e.login(A)}),s()()),t&2&&(a(2),r("form",e.form))},dependencies:[U,V,R],encapsulation:2})}}return o})();var ct=[{path:G.Login,component:oe},{path:G.Signup,component:ee}];export{ct as AUTH_ROUTES};
