import{i as K,j as q}from"./chunk-F2IZEKVL.js";import{a as H}from"./chunk-7Y7O4CRB.js";import"./chunk-TC4YL6MJ.js";import"./chunk-LJQV5NXZ.js";import"./chunk-VFFUA34V.js";import{d as _,o as L}from"./chunk-Q4JR3AAV.js";import"./chunk-UPX2NF3Z.js";import{Gb as z,ib as D,jb as U,kb as T,mb as I,sa as c}from"./chunk-FQ7J7ZTL.js";import{$a as s,$b as A,Ab as h,Ba as o,Cb as O,Gb as l,Hb as x,Hc as B,Ib as S,Ic as N,Kb as w,Nc as j,Pa as g,Ra as r,Yc as G,_ as f,_b as E,ab as i,bb as d,ca as u,dc as R,fc as M,g as k,gc as $,ic as y,kb as v,rb as C,sb as p,tb as F,ub as P,vb as b}from"./chunk-NE7DBUAQ.js";var Z=e=>({"border-right":e});function tt(e,m){if(e&1&&(s(0,"div",2)(1,"header",3),p(2),i(),s(3,"div",4)(4,"span"),p(5),i(),d(6,"app-icon",5),i()()),e&2){let t=m.$implicit,n=m.index,a=v();r("ngStyle",O(5,Z,n===a.stats.length-1?"none":"")),o(2),F(t.title),o(3),P(" ",t.content," "),o(),r("icon",t.icon)("size",48)}}var V=(()=>{class e{getItemKey(t,n){return n.id}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=u({type:e,selectors:[["app-stats"]],inputs:{stats:"stats"},standalone:!0,features:[h],decls:2,vars:2,consts:[[1,"stats"],["class","stat",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"stat",3,"ngStyle"],[1,"title"],[1,"content"],[3,"icon","size"]],template:function(n,a){n&1&&(s(0,"article",0),g(1,tt,7,7,"div",1),i()),n&2&&(o(),r("ngForOf",a.stats)("ngForTrackBy",a.getItemKey))},dependencies:[y,E,R,z],styles:[".stats[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid var(--secondary-dark);border-radius:90px}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:16px 40px;border-right:1px solid var(--secondary-dark);width:360px}.title[_ngcontent-%COMP%]{font-size:1rem;opacity:.5}.content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:48px;font-weight:700;margin-bottom:4px;color:var(--primary);width:100%}@media screen and (max-width: 820px){.stats[_ngcontent-%COMP%]{flex-direction:column;border-radius:8px;border-bottom:0}.stat[_ngcontent-%COMP%]{border-bottom:1px solid var(--secondary-dark);border-radius:8px;border-right:0}.stat[_ngcontent-%COMP%]:not(:last-child){border-bottom-right-radius:0;border-bottom-left-radius:0}}@media screen and (max-width: 768px){.stat[_ngcontent-%COMP%]{width:280px}}"],changeDetection:0})}}return e})();function et(e,m){if(e&1&&(s(0,"h2",6),p(1),l(2,"date"),l(3,"date"),i()),e&2){let t=m.ngIf;o(),b(" Metrics from ",S(2,2,t.start,"shortDate")," to ",S(3,5,t.end,"shortDate")," ")}}function nt(e,m){if(e&1&&(s(0,"article",3),g(1,et,4,8,"h2",4),l(2,"async"),s(3,"div",5)(4,"h2",6),p(5,"Totals"),i(),d(6,"app-stats",7)(7,"app-stats",7),i(),d(8,"div",8),s(9,"div",5)(10,"h2",6),p(11,"Averages"),i(),d(12,"app-stats",7)(13,"app-stats",7),i(),d(14,"div",8),i()),e&2){let t=v();o(),r("ngIf",x(2,5,t.dateRange$)),o(5),r("stats",t.stats),o(),r("stats",t.tasksStats),o(5),r("stats",t.dayStats),o(),r("stats",t.weekStats)}}function it(e,m){if(e&1&&(s(0,"h2"),p(1),l(2,"date"),l(3,"date"),i()),e&2){let t=m.ngIf;o(),b(" No timesheets found between dates ",S(2,2,t.start,"longDate")," and ",S(3,5,t.end,"longDate"),"! ")}}function ot(e,m){e&1&&(s(0,"h2"),p(1,"No timesheets found!"),i())}function rt(e,m){if(e&1&&(g(0,it,4,8,"h2",9),l(1,"async"),g(2,ot,2,0,"ng-template",null,1,w),s(4,"p"),p(5," Create a timesheet with any profile to see your their metrics here, or change the date range by clicking on 'App Date Range' input "),i()),e&2){let t=C(3),n=v();r("ngIf",x(1,2,n.dateRange$))("ngIfElse",t)}}var W=(()=>{class e{constructor(){this.app=f(_),this.dateRange$=this.app.dateRange$,this.Icons=c}get tasksStats(){return this.toTasksStats(this.avgMetrics)}get stats(){return this.toStats(this.avgMetrics)}get dayStats(){return this.toAvgStats(this.avgMetrics?.dayAvgs,"d")}get weekStats(){return this.toAvgStats(this.avgMetrics?.weekAvgs,"w")}toTasksStats(t){return t?[{id:1,title:"Total tasks",content:t.totalTasks,icon:c.Assignment},{id:2,title:"Total hours",content:T.numberToTime(t.workedHours),icon:c.Timelapse}]:[]}toStats(t){return t?[{id:1,title:"Registered days",content:t.total,icon:c.CalendarToday},{id:2,title:"Average rating",content:t.averageRating,icon:c.Star}]:[]}toAvgStats(t,n){if(!t)return[];let a=n==="d"?"day":"week";return[{id:1,title:"Average tasks per "+a,content:t.totalTasks.toFixed(2),icon:c.Assignment},{id:2,title:"Average hours per "+a,content:T.numberToTime(+t.workedHours.toFixed(0)),icon:c.Timelapse}]}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=u({type:e,selectors:[["app-metrics-stats"]],inputs:{avgMetrics:"avgMetrics"},standalone:!0,features:[h],decls:3,vars:2,consts:[["noMetrics",""],["noRange",""],["class","stat-contents",4,"ngIf","ngIfElse"],[1,"stat-contents"],["class","stat-title",4,"ngIf"],[1,"stat-section"],[1,"stat-title"],[3,"stats"],[1,"divider"],[4,"ngIf","ngIfElse"]],template:function(n,a){if(n&1&&g(0,nt,15,7,"article",2)(1,rt,6,4,"ng-template",null,0,w),n&2){let Y=C(2);r("ngIf",a.avgMetrics)("ngIfElse",Y)}},dependencies:[y,A,M,$,V],styles:["@keyframes _ngcontent-%COMP%_pulse{0%{background:#fff}50%{background:var(--primary-lighter)}to{background:#fff}}@keyframes _ngcontent-%COMP%_delay-position{0%{position:initial}to{position:absolute}}.stat-contents[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;row-gap:32px;margin-bottom:32px;width:100%;overflow-x:hidden}.stat-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:24px}.stats[_ngcontent-%COMP%]{border:1px solid var(--secondary-dark);border-radius:16px;border-bottom:0}.divider[_ngcontent-%COMP%]{border-bottom:2px solid #43484b;padding-bottom:0;width:100%}.stat-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:400;opacity:.8}"],changeDetection:0})}}return e})();var X=(()=>{class e{constructor(){this.app=f(_),this.timesheetService=f(K),this.profileService=f(L),this.avgMetrics$=this.timesheetService.avgMetrics$,this.destroyed$=new k,this.Icons=c,this.today=new Date,this.twoMonthsAgo=D.addMonths(this.today,-2),this.twoMonthsFromNow=D.addMonths(this.today,2)}get range(){return this.filterForm.controls.range}ngOnInit(){this.profileService.loadUserProfiles(),this.timesheetService.loadListData(),this.initFilterForm(),this.initSubs()}ngOnDestroy(){I.completeDestroy(this.destroyed$)}initFilterForm(){let{start:t,end:n}=this.app.getDateRangeOrDefault();this.filterForm=new N({range:U.buildDateRangeGroup(t,n)})}initSubs(){I.createAppDateRangeSub(this.range,this.app,this.destroyed$)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=u({type:e,selectors:[["app-metrics"]],standalone:!0,features:[h],decls:4,vars:7,consts:[["app-form-layout","",1,"search-bar",3,"id","formGroup"],["fgName","range","labelText","App Date Range",3,"minDate","maxDate"],[3,"avgMetrics"]],template:function(n,a){n&1&&(s(0,"header",0),d(1,"app-date-range-picker",1)(2,"app-metrics-stats",2),l(3,"async"),i()),n&2&&(r("id","cMetrics")("formGroup",a.filterForm),o(),r("minDate",a.twoMonthsAgo)("maxDate",a.twoMonthsFromNow),o(),r("avgMetrics",x(3,5,a.avgMetrics$)))},dependencies:[y,M,G,B,j,q,H,W],styles:[".search-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}app-date-range-picker[_ngcontent-%COMP%]{width:100%}"]})}}return e})();var Ut=[{path:"",component:X}];export{Ut as METRICS_ROUTES};
