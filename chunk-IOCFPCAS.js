import{a as H}from"./chunk-UGEFVKGU.js";import{$a as i,$b as A,Ba as s,Bc as U,Ca as P,Gb as v,Gc as W,Ib as E,Kb as D,Lc as R,Ob as I,Pa as _,Ra as g,Rc as j,Sc as L,Tc as z,X as C,Xc as B,_b as F,a as k,ab as o,b as T,ca as y,da as u,fb as w,gc as N,ib as h,ic as V,ja as m,ka as p,kb as l,rb as S,sb as a,tb as f,wb as M,xb as x,yb as O,zc as b}from"./chunk-NE7DBUAQ.js";function Q(n,d){if(n&1&&(i(0,"option",12),a(1),o()),n&2){let e=d.$implicit;g("value",e),s(),f(e)}}function X(n,d){n&1&&(i(0,"div")(1,"p"),a(2,"No hay tareas finalizadas."),o()())}function Y(n,d){if(n&1&&(i(0,"tr")(1,"td"),a(2),o(),i(3,"td"),a(4),o(),i(5,"td"),a(6),o(),i(7,"td"),a(8),o(),i(9,"td"),a(10),v(11,"date"),o()()),n&2){let e=d.$implicit;s(2),f((e.assignedUser==null?null:e.assignedUser.userName)||"N/D"),s(2),f(e.title),s(2),f(e.estimatedTime),s(2),f(e.actualTimeWorked),s(2),f(E(11,5,e.finishedAt,"short"))}}function Z(n,d){if(n&1&&(i(0,"table",13)(1,"thead")(2,"tr")(3,"th"),a(4,"Usuario"),o(),i(5,"th"),a(6,"Tarea"),o(),i(7,"th"),a(8,"Estimado"),o(),i(9,"th"),a(10,"Trabajado"),o(),i(11,"th"),a(12,"Finalizado"),o()()(),i(13,"tbody"),_(14,Y,12,8,"tr",14),o()()),n&2){let e=l(2);s(14),g("ngForOf",e.tasks)}}function $(n,d){if(n&1){let e=w();i(0,"section",2)(1,"h2"),a(2,"Tareas completadas"),o(),i(3,"div",3)(4,"div",4)(5,"span"),a(6,"Desde:"),o(),i(7,"input",5),O("ngModelChange",function(t){m(e);let c=l();return x(c.fromDate,t)||(c.fromDate=t),p(t)}),o()(),i(8,"div",4)(9,"span"),a(10,"Hasta:"),o(),i(11,"input",5),O("ngModelChange",function(t){m(e);let c=l();return x(c.toDate,t)||(c.toDate=t),p(t)}),o()(),i(12,"div",4)(13,"span"),a(14,"Usuario:"),o(),i(15,"select",6),O("ngModelChange",function(t){m(e);let c=l();return x(c.selectedUser,t)||(c.selectedUser=t),p(t)}),h("change",function(){m(e);let t=l();return p(t.filtrarPorFechas())}),i(16,"option",7),a(17,"Todos"),o(),_(18,Q,2,2,"option",8),o()(),i(19,"button",9),h("click",function(){m(e);let t=l();return p(t.filtrarPorFechas())}),a(20,"Filtrar"),o(),i(21,"button",9),h("click",function(){m(e);let t=l();return p(t.resetFiltro())}),a(22,"Limpiar"),o()(),_(23,X,3,0,"div",10)(24,Z,15,1,"table",11),o()}if(n&2){let e=l();s(7),M("ngModel",e.fromDate),s(4),M("ngModel",e.toDate),s(4),M("ngModel",e.selectedUser),s(3),g("ngForOf",e.userList),s(5),g("ngIf",e.tasks.length===0),s(),g("ngIf",e.tasks.length>0)}}function ee(n,d){n&1&&(i(0,"p"),a(1,"Cargando tareas completadas..."),o())}var G=(()=>{class n{constructor(e,r){this.taskService=e,this.cdr=r,this.tasks=[],this.loading=!0,this.fromDate="",this.toDate="",this.originalTasks=[],this.selectedUser="all",this.userList=[]}ngOnInit(){this.taskService.getCompletedTasks().subscribe({next:e=>{let r=e.map(t=>T(k({},t),{finishedAt:t.finishedAt?new Date(t.finishedAt):null}));this.tasks=[...r].sort((t,c)=>!t.finishedAt||!c.finishedAt?0:c.finishedAt.getTime()-t.finishedAt.getTime()),this.originalTasks=[...this.tasks],this.userList=Array.from(new Set(this.tasks.map(t=>t.assignedUser?.userName).filter(t=>!!t))).sort(),this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error al obtener tareas completadas",e),this.loading=!1,this.cdr.detectChanges()}})}filtrarPorFechas(){let e=this.fromDate?new Date(this.fromDate):null,r=this.toDate?new Date(this.toDate):null;this.tasks=this.originalTasks.filter(t=>{let c=(!e||t.finishedAt&&t.finishedAt>=e)&&(!r||t.finishedAt&&t.finishedAt<=r),K=this.selectedUser==="all"||t.assignedUser?.userName===this.selectedUser;return c&&K})}resetFiltro(){this.tasks=[...this.originalTasks],this.fromDate="",this.toDate="",this.selectedUser="all"}static{this.\u0275fac=function(r){return new(r||n)(P(H),P(I))}}static{this.\u0275cmp=y({type:n,selectors:[["app-completed-tasks"]],decls:3,vars:2,consts:[["loadingTpl",""],["class","completed-container",4,"ngIf","ngIfElse"],[1,"completed-container"],[1,"filter-bar"],[1,"filter-item"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[4,"ngIf"],["class","completed-table",4,"ngIf"],[3,"value"],[1,"completed-table"],[4,"ngFor","ngForOf"]],template:function(r,t){if(r&1&&_(0,$,25,6,"section",1)(1,ee,2,0,"ng-template",null,0,D),r&2){let c=S(2);g("ngIf",!t.loading)("ngIfElse",c)}},dependencies:[F,A,L,z,U,j,W,R,N],styles:[".completed-container[_ngcontent-%COMP%]{padding:1rem}.completed-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem}.completed-container[_ngcontent-%COMP%]   .task-card[_ngcontent-%COMP%]{background-color:#1e1e1e;padding:1rem;border-radius:8px;margin-bottom:1rem;color:#e0e0e0}.completed-container[_ngcontent-%COMP%]   .task-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem}.completed-container[_ngcontent-%COMP%]   .task-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;color:#ccc}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{padding:.4rem .6rem;border:1px solid #444;background-color:#1e1e1e;color:#fff;border-radius:4px;outline:none;transition:border-color .2s}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]:focus{border-color:#007acc}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;height:38px;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:background-color .2s}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{background-color:#007acc;color:#fff}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type:hover{background-color:#005fa3}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-of-type{background-color:#444;color:#fff}.completed-container[_ngcontent-%COMP%]   .filter-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-of-type:hover{background-color:#666}.completed-container[_ngcontent-%COMP%]   .completed-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;color:#e0e0e0;background-color:#1e1e1e;border-radius:8px;overflow:hidden}.completed-container[_ngcontent-%COMP%]   .completed-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .completed-container[_ngcontent-%COMP%]   .completed-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #333;text-align:left;font-size:.9rem}.completed-container[_ngcontent-%COMP%]   .completed-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#292929;font-weight:600}.completed-container[_ngcontent-%COMP%]   .completed-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#2e2e2e}.completed-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.4rem .6rem;background-color:#1e1e1e;color:#fff;border:1px solid #444;border-radius:4px;font-size:.9rem}.completed-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007acc}"]})}}return n})();var te=[{path:"completed-tasks",component:G}],J=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=u({type:n})}static{this.\u0275inj=C({imports:[b.forChild(te),b]})}}return n})();var _e=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=u({type:n})}static{this.\u0275inj=C({imports:[V,J,B]})}}return n})();export{_e as ReportsModule};
