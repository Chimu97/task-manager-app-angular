import"./chunk-YPTYWC2K.js";import{c as Z,d as ee}from"./chunk-S73WMLDN.js";import"./chunk-XMFNPTOA.js";import{a as H}from"./chunk-TEQY3GTC.js";import{a as X}from"./chunk-ITUVS2WK.js";import"./chunk-23P6OKCW.js";import{a as W}from"./chunk-7Y7O4CRB.js";import"./chunk-O3HPPMHU.js";import{a as z}from"./chunk-LJQV5NXZ.js";import"./chunk-Z5PEOYQJ.js";import"./chunk-7G2AXBS3.js";import{C as Q,g as q,m as K,s as g}from"./chunk-Y4NPCKFB.js";import{f as B,g as J}from"./chunk-OOKJWEDJ.js";import{Aa as A,Fa as S,Xa as G,jb as P,mb as V,pb as Y,qa as x,ta as E,wa as j,ya as v}from"./chunk-4MVBMYBR.js";import{$a as n,Ab as h,Ba as s,Hc as k,Ic as L,Kc as C,Mc as $,Nc as O,R as w,Ra as m,W as u,Yc as R,Z as U,_ as i,a as c,ab as l,b as f,bb as y,ca as d,d as a,g as _,ib as p,ic as D,sa as b,sb as F,wc as N}from"./chunk-NE7DBUAQ.js";var I=(()=>{class e extends L{static from(t){return new e(t)}static getFormKeys(){return["name","userName"]}static{this.toJson=t=>t.getRawValue()}}return e})(),te=()=>({name:new C("",{nonNullable:!0,validators:Z}),userName:new C("",{nonNullable:!0,validators:ee})});var oe=(()=>{class e{constructor(){this.modalService=i(Q),this.save=new b,this.cancel=new b,this.formType=S.Edit,this.elIds=v}get submitLabel(){return P.getSubmitLabel(this.formType)}get controls(){return this.form.controls}onCancel(){this.cancel.emit()}openSaveModal(){this.modalService.confirmation(A(),()=>P.onSubmit(this.form,this.save))}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=d({type:e,selectors:[["app-my-profile-form"]],inputs:{form:"form"},outputs:{save:"save",cancel:"cancel"},standalone:!0,features:[h],decls:9,vars:5,consts:[["app-form-layout","",1,"form-layout",3,"ngSubmit","id","formGroup"],[1,"form-grid",3,"appScrollTo"],["fcName","userName","labelText","Username","placeholder","Your username"],["fcName","name","labelText","Name","placeholder","Your name"],[1,"form-buttons"],["model","raised","elId","cMyProfileFormCancel","color","accent",3,"clicked"],["model","raised","type","submit",3,"elId","disabled"]],template:function(o,r){o&1&&(n(0,"form",0),p("ngSubmit",function(){return r.openSaveModal()}),n(1,"div",1),y(2,"app-input",2)(3,"app-input",3),n(4,"div",4)(5,"app-button",5),p("clicked",function(){return r.onCancel()}),F(6,"Cancel"),l(),n(7,"app-button",6),F(8,"Update"),l()()()()),o&2&&(m("id",r.elIds.MyProfileForm)("formGroup",r.form),s(),m("appScrollTo",!0),s(6),m("elId",r.elIds.MyProfileSubmit)("disabled",r.form.invalid))},dependencies:[R,$,k,O,W,H,X,J],changeDetection:0})}}return e})();var re=(()=>{class e{constructor(t){this.api=t,this.myProfileUrl=Y.buildApiUrl(x.MyProfile),this.updateMyProfile=o=>a(this,null,function*(){return this.api.patch(f(c({},G.put(this.myProfileUrl,o.id,o)),{customData:{loadings:B.createManyFromId(v.MyProfileSubmit)}}))})}static{this.\u0275fac=function(o){return new(o||e)(U(K))}}static{this.\u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ie=(()=>{class e{constructor(){this.api=i(re),this.authService=i(g),this.router=i(N),this.toaster=i(q)}updateMyProfile(t){return a(this,null,function*(){let o=Number(this.authService.currentUserId);if(!o){this.toaster.error("There was an error while getting your ID!");return}yield this.api.updateMyProfile(f(c({},t),{id:+o})),yield this.authService.refreshLoggedUser(),this.toaster.success("Your profile was updated successfully!")})}goToIndex(){return this.router.navigateByUrl(j.home)}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ne=(()=>{class e{constructor(){this.service=i(ie),this.authService=i(g),this.destroyed$=new _,this.loggedUser$=this.authService.loggedUser$,this.FormTypes=S,this.subscriptions=[]}ngOnInit(){this.runInitMethods()}ngOnDestroy(){V.completeDestroy(this.destroyed$)}runInitMethods(){this.initForm(),this.initSubs()}initSubs(){this.loggedUser$.pipe(w(this.destroyed$)).subscribe(t=>{this.initForm(t??void 0)})}initForm(t){this.form==null&&(this.form=I.from(te())),this.form.patchValue(t??{})}submitForm(){return this.editItem()}editItem(){return a(this,null,function*(){let t=I.toJson(this.form);return this.service.updateMyProfile(t)})}onCancel(){return this.service.goToIndex()}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=d({type:e,selectors:[["app-my-profile"]],standalone:!0,features:[h],decls:3,vars:2,consts:[[1,"my-profile-container"],["subtitle","Edit your data",3,"titleText"],[3,"cancel","save","form"]],template:function(o,r){o&1&&(n(0,"section",0),y(1,"app-title",1),n(2,"app-my-profile-form",2),p("cancel",function(){return r.onCancel()})("save",function(){return r.submitForm()}),l()()),o&2&&(s(),m("titleText","My Profile"),s(),m("form",r.form))},dependencies:[D,oe,z],styles:[".my-profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;row-gap:32px}"],changeDetection:0})}}return e})();var rt=[{path:E.MyProfile,component:ne}];export{rt as SETTINGS_ROUTES};
